---
title: "Benefit Transfer"
author: "Natalie Smith"
format: 
  html:
    code-fold: true
    toc: true
    number-sections: true
    embed-resources: true
theme: Litera
editor: visual
execute:
  echo: true
  message: false
  warning: false
---

# Introduction

Coastal wetlands provide a natural defense against storm surges and the effects of sea-level rise. They act like a sponge that dissipates wave impacts and reduces flood risk. In this homework, you will help derive the value of wetlands for a study in Huntington Beach, California. Valuing wetland restoration You will contribute to a study on wetlands restoration in Huntington Beach, California, which has an area of 60 hectares of salt marsh to restore. You will conduct a benefits transfer analysis, drawing on several other studies.

After some work, you identified the following: ● Bayraktov et al. (2015): a meta-analysis of coastal wetland restoration costs. Specifically, you have access to the mangrove and salt marsh databases. ● Costanza et al. (2021): estimate the storm protection benefits (avoided damage).

Data You have part of the dataset of Bayraktov et al. (2015). We called this database cost_df, and it has the following information:

-   study_cluster: research belonging to a specific year
-   wetland_type: mangrove or saltmarsh
-   observation: research ID
-   reference: authors
-   ref_year: publication year
-   country: country where the restoration project took place
-   area_ha: restoration area
-   total_cost_2010: total restoration cost in USD2010

# Part 1:

Restoration costs

You will employ a benefit transfer to find the costs of restoring 60 hectares of wetland.

```{r}
#load libraries
library(tidyverse)
library(here)
library(knitr)
library(kableExtra)

#import data
cost_df <- read.csv(here("data", "cost_df.csv"))
```

## 1)

Inspect the dataset. What wetland type is most appropriate for your analysis? Filter the dataset for that wetland type.

```{r}
#inspect the dataset
unique(cost_df$wetland_type)

#filter dataset for wetlands type
wetland_df <- cost_df %>% 
  filter(wetland_type == "saltmarsh") %>% 
  drop_na()
```

Saltmarsh is the most appropriate for our analysis.

## 2)

Create a new variable with the restoration costs per hectare. Then, choose one of the research studies and estimate the total costs of restoring 60 hectares in Huntington Beach. Explain your choice.

```{r}
#create a new variable with restoration costs per hectare
wetland_df <- wetland_df %>%
  mutate(cost_per_ha = total_cost_2010 / area_ha)

#show me the study with the closest area to 60 hectares
# wetland_df %>% 
#   filter(area_ha > 40 & area_ha < 100) %>% 
#   select(observation, area_ha, total_cost_2010, cost_per_ha)

# hb_wetland_df <- wetland_df %>% 
#   filter(observation == 126)

# head(hb_wetland_df)

```

Given that the salt marsh I aim to restore spans 60 hectares, I will select a study from the dataset with the area that most closely matching this size. The study with the closest match is the one with an observation ID of 126, which covers 44.5 hectares and has a cost of $213,689.9 per hectare. Based on this rate, the estimated total cost to restore 60 hectares of salt marsh in Huntington Beach is approximately $12,821,394.

## 3)

We are interested in the marginal cost of each additional hectare restored. Make a scatter plot of hectares on the y-axis and total restoration costs on the x-axis. Describe the relationship between total costs and wetland area restored.

```{r, fig.cap="Figure 1: Update caption"}
# #scatter plot
# ggplot(wetland_df, aes(x = area_ha, y = total_cost_2010)) +
#   geom_point() +
#   labs(title = "Total restoration costs by wetland area",
#        x = "Wetland area (ha)",
#        y = "Total restoration costs (USD2010)") +
#   theme_bw()

# The above scatteplot shows all the points very close to each other, making it difficult to see the relationship between area and costs.To better visualize, I will log-transform the axes.

# Scatter plot with log-transformed axes
ggplot(wetland_df, aes(x = area_ha, y = total_cost_2010)) +
  geom_point() +
  scale_x_log10() +  # Log transform x-axis
  scale_y_log10() +  # Log transform y-axis
  labs(title = "Total Restoration Costs by Saltmarsh Area",
       x = "Saltmarsh Area (ha, log scale)",
       y = "Total Restoration Costs (USD2010, log scale)") +
  theme_bw()
```

## 4)

Run the following regression: total_cost_2010 = a + b\*area_ha + error. Using the outcome of this regression, recalculate the total cost of restoring 60 hectares of wetland.

```{r}
#run regression
lm_cost <- lm(total_cost_2010 ~ area_ha, data = wetland_df)

summary(lm_cost)
```

```{r}
#recalculate total cost with 60 ha of wetland
hb_cost <- predict(lm_cost, data.frame(area_ha = 60))
```


## 5)

Describe one way you could improve your cost analysis and valuation.

# Part 2:

Storm protection benefits

Costanza et al. (2021) analyzed 1288 coastal storms globally to calculate the storm protection benefits from wetlands. The authors obtained the following regression estimates: $$
ln(damages/GDP) = -7.992 - 0.236ln(wetlands) + 3.298ln(wind speed) - 
0.55ln(speed) + 0.137(volume) - 0.058(time)
$$

They have the following variables:

-   Damages/GDP wind speed of the storm (windspeed)
-   Forward speed of the storm (speed) wetland area in the swath of the storm (wetlands)
-   Volume of water in the ocean proximal to the storm landfall (volume)
-   Year of the storm minus 1900 (time) as a (non-transformed) linear variable.

## 6)

Interpret the coefficient on ln(wetlands). (Hint: notice that the dependent variable is also log-transformed)

## 7)

Calculate the avoided damage of 60 additional hectares of wetlands in case of a storm like Hurricane Hilary. You have the following information: damages = \$18 million, and the available wetland area today is 72 hectares. Assume the GDP doesn't change (only damage moves), and all the remaining variables remain constant.
